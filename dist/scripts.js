(()=>{"use strict";function e(e,t){return Math.floor(Math.random()*(t-e)+e)}const t=(e,t,n)=>{const i=e.getBoundingClientRect(),o=t.getBoundingClientRect();return n=n||{y1:0,y2:0},i.x<o.x+o.width&&i.x+i.width>o.x&&i.y<o.y+o.height+n.y1&&i.y+i.height>o.y+n.y2};let n,i,o,s,a,r,l,c,u,d,y,m,p;Object.assign(window,{detectCollision:t}),l=document.querySelector("#gameStart");let f=new class{constructor(){this.bgMusic=new Audio("./sounds/bg.wav"),this.bgMusic.volume=.03}playBg(){this.bgMusic.currentTime=0,this.bgMusic.loop=!0,this.bgMusic.play()}stopMusic(){this.bgMusic.pause()}};function g(){new Audio("./sounds/gameover.wav").play(),u=!0,r.style.display="",function(){const e=i.getBoundingClientRect().x;i.style.animation="",o.style.animation="",i.style.left=`${e}px`,o.style.left=`${e}px`}(),p=!0,M(),f.stopMusic(),n.style.animation="",console.log("game over")}function w(){a.innerText=`score : ${y}`,r.querySelector(".score").innerText=`score : ${y}`}const h={slow:150,normal:250,fast:350,superfast:450,ridiculous:550};function v(){d=!0;let e=0,t=setInterval((()=>{b({diff:-3,direction:"up"}),e>20&&(new Audio("./sounds/fly.wav").play(),clearInterval(t),d=!1,e=0),e++}),10)}function b({diff:n,direction:a}){"none"!==c.style.display&&t(s,c)&&(new Audio("./sounds/star.wav").play(),y+=150,M(),w()),function(e){"down"===e?(character.classList.remove("go-up"),character.classList.add("go-down")):(character.classList.remove("go-down"),character.classList.add("go-up"))}(a),function(e){const t=(i=s,"top",window.getComputedStyle(i).getPropertyValue("top")),n=parseInt(t)+e;var i;if(!(n<0))n>window.innerHeight?g():s.style.top=`${n}px`}(n),function(){const n=t(s,i),a=t(s,o,{y1:-46,y2:47});if(n&&!a)return g();if(a){if(L++,L>35&&(new Audio("./sounds/hole.wav").play(),L=0),y++,w(),u)return;S++,S>150&&("none"===c.style.display&&(c.style.display="",c.style.top=`${e(20,100)}px`),setTimeout((()=>{M()}),4500),S=0),console.log({numHoles:S})}}(),function(){let e=!1;y>2e3?(m="ridiculous",e=!0):y>1e3?(m="superfast",e=!0):y>500?(m="fast",e=!0):y>250&&(m="normal",e=!0),e&&(o.addEventListener("animationiteration",(()=>{q()})),i.addEventListener("animationiteration",(()=>{q()})))}()}let S=0,L=0;function x(){o.addEventListener("animationiteration",(()=>{const t=e(60*innerHeight/100,95*innerHeight/100);o.style.top=`-${t}px`}))}function q(){const t=((e,t=2)=>Math.round((e+Number.EPSILON)*10**t)/10**t)(innerHeight/h[m]),n=`blockAnimation ${t}s linear infinite`;if(i.style.animation=n,o.style.animation=n,"none"!==c.style.display)return;const s=`startAnimation${e(1,5)} ${t}s linear infinite`;c.style.animation=s}function M(){c.style.display="none"}function $(){n.style.animation="backgroungAnimation 5s linear infinite"}function E(){u=!1,d=!1,y=0,m="slow",p=!1,n=document.querySelector("#game"),i=document.querySelector("#block"),o=document.querySelector("#hole"),s=document.querySelector("#character"),a=document.querySelector("#score"),r=document.querySelector("#gamescreen"),c=document.querySelector("#star"),q(),x(),addEventListener("resize",(()=>{u||x()})),r.querySelector("button").addEventListener("click",(()=>{m="slow",r.style.display="none",p=!1,y=0,w(),q(),s.style.top="20vh",s.style.left="40vh",$(),setTimeout((()=>{u=!1})),f.playBg()})),document.body.addEventListener("click",(()=>{u||v()})),addEventListener("keydown",(e=>{u||32===(e=e||window.event).keyCode&&v()})),setInterval((()=>{d||p||b({diff:5,direction:"down"})}),20),$()}l.querySelector("button").addEventListener("click",(()=>{E(),f.playBg(),l.style.display="none"}))})();